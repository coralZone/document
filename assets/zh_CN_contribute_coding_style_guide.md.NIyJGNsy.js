import{_ as s,c as i,o as a,a2 as n}from"./chunks/framework.BZKnb7tL.js";const E=JSON.parse('{"title":"编码风格指南","description":"","frontmatter":{},"headers":[],"relativePath":"zh_CN/contribute/coding_style_guide.md","filePath":"zh_CN/contribute/coding_style_guide.md"}'),l={name:"zh_CN/contribute/coding_style_guide.md"},e=n(`<h1 id="编码风格指南" tabindex="-1">编码风格指南 <a class="header-anchor" href="#编码风格指南" aria-label="Permalink to &quot;编码风格指南&quot;">​</a></h1><p>本文说明 xfusion 编码所使用的风格。</p><p>请遵守 xfusion 编码风格，统一编码风格可以减少因为风格转换带来的阅读成本。</p><hr><p><strong>适用范围：</strong></p><ul><li><em>外部库以外</em>的所有 c 头文件/源文件。</li></ul><p>TODO: xfusion cpp 语言代码编程规范</p><p><strong>阅读对象：</strong></p><ul><li>所有 c 语言代码贡献者。</li></ul><p><strong>非目标：</strong></p><ul><li>c 语言代码编程规范。本文只说明风格 xfusion 编码风格，编程规范（如如何提高代码安全性）不是本文目标，可以查阅： <ul><li><a href="https://google.github.io/styleguide/cppguide.html" target="_blank" rel="noreferrer">Google C++ Style Guide</a></li><li><a href="https://www.misra.org.uk/app/uploads/2022/12/MISRA-C-2012-AMD3.pdf" target="_blank" rel="noreferrer">MISRA C:2012 Amendment 3</a></li></ul></li></ul><hr><h1 id="xfusion-头文件-源文件模板" tabindex="-1">xfusion 头文件/源文件模板 <a class="header-anchor" href="#xfusion-头文件-源文件模板" aria-label="Permalink to &quot;xfusion 头文件/源文件模板&quot;">​</a></h1><p>xfusion 目前已经提供了 xfusion 内 c 语言代码头文件/源文件模板，提交到 xfusion 的代码请应用 xfusion 头文件/源文件模板。</p><p>空白模板见<code>examples/get_started/xf_template/blank_xf_template/</code>目录内的<code>xf_template.h/xf_template.c</code>。说明见<a href="#模板的说明">模板的说明</a>。</p><p>模板说明实例见<code>examples/get_started/xf_template/main</code>内的<code>xf_template_source_detail.h/xf_template_source_detail.c</code>。详情见下文。</p><h1 id="使用自动格式化" tabindex="-1">使用自动格式化 <a class="header-anchor" href="#使用自动格式化" aria-label="Permalink to &quot;使用自动格式化&quot;">​</a></h1><p>详情见：<a href="#">format_code/README.md</a>。</p><p><strong>请不要忽略该部分，自动格式化能节省大量的排版工作量。</strong></p><p>自动格式化会帮你完成在合适的运算符周围添加空格、缩进代码、限制连续空白行数、限制每行字符数等等工作。</p><h1 id="模板的说明" tabindex="-1">模板的说明 <a class="header-anchor" href="#模板的说明" aria-label="Permalink to &quot;模板的说明&quot;">​</a></h1><p>该小节介绍 xfusion 的 c 语言头文件/源文件模板的组成部分。</p><p>只需了解模板各个部分的作用即可，需要使用时请从<code>examples/get_started/xf_template/blank_xf_template/</code>目录内复制出来并修改。</p><p>所有 c/cpp 代码文件的总体要求如下（自动格式化会帮你完成这些总体要求）：</p><ol><li>使用 4 个空格替代<code>TAB</code>，并且<strong>不要</strong>使用制表符缩进代码；</li><li>行尾<strong>不要</strong>尾随空格；</li><li>每行字数<strong>推荐不超过 80 个字符</strong>，最多 120 字符（含）； <blockquote><p>如果每行少于 80 个字符，在 vscode 中两栏对照查看代码时能全部看完，而不用水平滚动或开启换行显示。</p></blockquote></li><li>文件编码格式为 <strong>UTF-8</strong> 格式；</li><li>使用 Unix 风格的 <strong>LF</strong> 行结束符，而不是 Windows 风格的 CRLF 行结束符。</li></ol><h2 id="头文件模板" tabindex="-1">头文件模板 <a class="header-anchor" href="#头文件模板" aria-label="Permalink to &quot;头文件模板&quot;">​</a></h2><p>头文件模板由以下几个部分组成：</p><ul><li><p>文件描述。如以下代码所示，至少需要包含文件名、作者、简介、版本、日期、版权声明这几个部分。</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@file</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> xf_template.h</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@author</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> your name (you@domain.com)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> xfusion 头文件空白模板。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@version</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@date</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 2023-10-23</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Copyright (c) 2023, CorAL. All rights reserved.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li><p>防止头文件重复包含的宏。 要点：</p><ol><li>修改宏名为当前文件名的大写格式，不含点&#39;.&#39;以及其他无法作为宏定义的字符。</li><li>以<strong>双</strong>下划线开头和结尾这个宏。</li><li>在宏的<code>#endif</code>结尾，注释说明该<code>#endif</code>的归属，如<code>#endif /* __XF_TEMPLATE_H__ */</code>。</li></ol><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __XF_TEMPLATE_H__</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /*!&lt; 修改为文件名对应的定义 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __XF_TEMPLATE_H__</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* __XF_TEMPLATE_H__ */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li><li><p><code>extern &quot;C&quot;</code>。 用于 c++ 程序调用时声明该程序是 c 源程序。注意！<code>extern &quot;C&quot;</code>在<code>#include</code>之后。</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xf_def.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 注意\`extern &quot;C&quot;\`在\`#include\`之后。 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __cplusplus</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extern</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> __cplusplus</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* extern &quot;C&quot; */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li><li><p>内容提示符及对应内容。 注意头文件与源文件的内容提示符不完全相同。 <strong>其他内容应当与内容提示符保持上下各一空行的间隔。</strong> 头文件的内容提示符包含以下内容：</p><ol><li>头文件<code>Includes</code>。 <blockquote><p>如：<code>#include &quot;xf_def.h&quot;</code>；</p></blockquote></li><li>宏定义(无参宏)<code>Defines</code>。 <blockquote><p>如：<code>#define FOO (1)</code>；</p></blockquote></li><li>类型定义<code>Typedefs</code>。 <blockquote><p>如：<code>typedef int xf_templ_int_t;</code>；</p></blockquote></li><li>全局函数原型<code>Global Prototypes</code>。 <blockquote><p>如：<code>int global_func(int args);</code>；</p></blockquote></li><li>宏函数(有参宏)<code>Macros</code>。 <blockquote><p>如：<code>#define XF_TEMPLATE_MACROS_ADD(_a, _b) ((_a) + (_b))</code>；</p></blockquote></li></ol><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 头文件包含的内容提示符 */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Includes]  ========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Defines]   =========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Typedefs]  ========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Global Prototypes]  ================================= */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Macros]    ============================================ */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul><h2 id="源文件模板" tabindex="-1">源文件模板 <a class="header-anchor" href="#源文件模板" aria-label="Permalink to &quot;源文件模板&quot;">​</a></h2><p>源文件模板由以下几个部分组成：</p><ul><li><p>文件描述。格式同头文件模板。</p></li><li><p>内容提示符及对应内容。 注意头文件与源文件的内容提示符不完全相同。 <strong>其他内容应当与内容提示符保持上下各一空行的间隔。</strong> 源文件的内容提示符包含以下内容：</p><ol><li>头文件<code>Includes</code>。 <blockquote><p>如：<code>#include &quot;xf_template.h&quot;</code>；</p></blockquote></li><li>宏定义(无参宏)<code>Defines</code>。 <blockquote><p>如：<code>#define BAR (1)</code>；</p></blockquote></li><li>类型定义<code>Typedefs</code>。 <blockquote><p>如：<code>typedef int int_t;</code>；</p></blockquote></li><li>静态函数原型<code>Static Prototypes</code>。 <blockquote><p>如：<code>int _static_func(int args);</code>；</p></blockquote></li><li>静态变量<code>Static Variables</code>。 <blockquote><p>如：<code>int s_val = 0;</code>；</p></blockquote></li><li>宏函数(有参宏)<code>Macros</code>。 <blockquote><p>如：<code>#define XF_TEMPLATE_MACROS_SUB(_a, _b) ((_a) - (_b))</code>；</p></blockquote></li><li>全局函数定义<code>Global Functions</code>。 <blockquote><p>如：<code>int global_func(int args) { return args; };</code>；</p></blockquote></li><li>静态函数定义<code>Static Functions</code>。 <blockquote><p>如：<code>int _static_func(int args) { return args; };</code>。</p></blockquote></li></ol><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 源文件包含的内容提示符 */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Includes]  ========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Defines]   =========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Typedefs]  ========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Static Prototypes]  ================================= */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Static Variables]   ================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Macros]    ============================================ */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Global Functions]   ================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Static Functions]   ================================== */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul><h1 id="编码风格说明" tabindex="-1">编码风格说明 <a class="header-anchor" href="#编码风格说明" aria-label="Permalink to &quot;编码风格说明&quot;">​</a></h1><p>该部分将详细介绍编码风格。注释风格请见《<a href="./code_comment_guide.html">代码注释指南</a>》。该文档说明如何写出符合 doxygen 格式要求的注释。</p><h2 id="缩进风格" tabindex="-1">缩进风格 <a class="header-anchor" href="#缩进风格" aria-label="Permalink to &quot;缩进风格&quot;">​</a></h2><p>xfusion c 源码缩进风格使用&quot;One True Brace Style&quot;，简称<code>1TBS</code>或<code>OTBS</code>，这是一种基于&quot;K&amp;R&quot;风格的变体。<code>1TBS</code>和<code>K&amp;R</code>最大的区别是，<code>1TBS</code>不允许单语句分支时省略花括号。此处不对缩进风格作详细介绍，详细内容请查阅<a href="https://en.wikipedia.org/wiki/Indentation_style" target="_blank" rel="noreferrer">Indentation style</a>。</p><p>xfusion 缩进风格的示例代码如下，详细示例见<code>examples/get_started/xf_template/main/xf_template_source_detail.c</code>。</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 主函数。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    xf_templ_int_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 分支语句哪怕只有一句也必须加花括号。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (XF_TEMPLATE_VERSION </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_VERSION_CHECK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error: version check failed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;version check: ok</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;version is </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%lu\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">uint32_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)XF_TEMPLATE_VERSION);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /*!&lt; 必要时此处需要添加判断条件，以说明该花括号的来源  */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    xf_component_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    xf_template_another_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    xf_template_init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _xf_template_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s_struct, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">val);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 常量在前可以避免不必要的逻辑错误。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * 如 if (XF_TEMPL_FAIL = ret) 时编译会报错。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (XF_TEMPL_FAIL </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ret) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error: ret is XF_TEMPL_FAIL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XF_TEMPL_FAIL;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ret: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ret);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ok</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XF_TEMPL_OK;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="命名风格" tabindex="-1">命名风格 <a class="header-anchor" href="#命名风格" aria-label="Permalink to &quot;命名风格&quot;">​</a></h2><h3 id="文件及目录命名风格" tabindex="-1">文件及目录命名风格 <a class="header-anchor" href="#文件及目录命名风格" aria-label="Permalink to &quot;文件及目录命名风格&quot;">​</a></h3><p>TODO: 文件及目录命名风格详细说明</p><p>如 xf_uart 所示：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>📦xf_uart</span></span>
<span class="line"><span> ┣ 📜xf_uart.c</span></span>
<span class="line"><span> ┣ 📜xf_uart.h</span></span>
<span class="line"><span> ┣ 📜xf_uart_port.h</span></span>
<span class="line"><span> ┗ 📜xf_uart_types.h</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>xf_uart.h: 当前模块对外提供的功能的头文件。通常提供给用户使用。</li><li>xf_uart.c: 当前模块功能的的实现。</li><li>xf_uart_port.h: 实现当前模块功能所需要的接口。用户通常无需使用。</li><li>xf_uart_types.h: 当前模块定义的数据类型。</li></ul><h3 id="内容-命名及排版-风格" tabindex="-1">内容(命名及排版)风格 <a class="header-anchor" href="#内容-命名及排版-风格" aria-label="Permalink to &quot;内容(命名及排版)风格&quot;">​</a></h3><p>由于头文件内的内容会被别处调用，通过命名空间标识来源是有必要的。</p><p><strong>命名空间：</strong></p><p>对于会被别处调用的代码，除非特殊情况，否则都<strong>要求</strong>加上命名空间（含全局变量，同时<strong>建议不使用</strong>全局变量）。 会被别处调用的代码包括但不限于：</p><ol><li>宏（含无参宏与带参宏）；</li><li>结构体、共用体、枚举类型等；</li><li>类型定义；</li><li>函数；</li><li>全局变量（建议不使用）。</li></ol><h4 id="宏" tabindex="-1">宏 <a class="header-anchor" href="#宏" aria-label="Permalink to &quot;宏&quot;">​</a></h4><p>宏定义(无参宏)是预处理指令中的一种，预处理阶段时会替换宏名为宏对应的替换列表。 格式为<code>#define 宏名 替换列表</code>。 如：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_HELP_STR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;xf_template v0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_HELP_STR_SPLICING</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   &quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XF_TEMPLATE_HELP_STR </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;abc123&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_DEFINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>宏函数(带参宏)。 格式为<code>#define 宏名(参数1,参数2,...,参数n) 替换列表</code>。 如：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 带参宏示例。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) ((_a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_b))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 无需返回参数的宏</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 1. 通常需要用 do { } while (0) 包围（除非通过宏定义变量等情况）。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 2. while (0) 后不要加分号（使用时强制加分号）。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_NO_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        s_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_b); </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 需要返回参数的宏</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 1. 使用 ({ }) 包围。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 2. 明显括出返回值。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_HAS_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ({                                      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_x) __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_x);            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_x);               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (__ret);                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 关于条件编译</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 1. 需要在对应的 #else 后追加相应的的条件（如：\`!defined(xf_printf)\`），</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *    在 #endif 后标注 #if 的信息（如：\`defined(xf_printf)\`）。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@note</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 如何宏需要缩进保持美观，请在&#39;#&#39;号后面缩进。如下缩进所示。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* xf_template 输出接口 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> xf_printf</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#   define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...)   </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xf_printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((_fmt), ##</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__VA_ARGS__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#else</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* !defined(xf_printf) */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#   define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPL_PRINTF</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_fmt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ...)   </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((_fmt), ##</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">__VA_ARGS__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* defined(xf_printf) */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#   define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                    ((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(_x))</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     /*!&lt; 未使用的变量 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p><strong>命名要点：</strong></p><ol><li>根据需要添加命名空间； 源文件(.c)内的定义的宏的名字可以不添加命名空间。<strong>推荐</strong>添加。 一旦需要被别的文件调用，就<strong>必须</strong>加上命名空间。</li><li>宏定义(无参宏)的宏名<strong>必须</strong>大写，如有特殊情况不大写宏定义时需要特殊注明；</li><li>宏函数(带参宏)的宏名<strong>通常</strong>大写，除了非常类似于函数的宏或者编译器特性宏以及其他约定成俗的情况；</li><li>宏函数(带参宏)的参数对大小写没有要求，但是通常<strong>推荐</strong>添加单下划线<code>_</code>以说明该参数是宏的参数，并且加以括号，防止表达式传入宏参数时造成逻辑错误；</li><li>能说明宏的作用。</li></ol><p><strong>格式要点：</strong></p><ol><li><p>宏对应的内容通常建议加括号，如下；</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_DEFINE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><p><strong>不要求</strong>对齐多个连续的宏名及其对应的内容，以及宏的继续符<code>\\</code>，除非代码已经稳定很少更改；</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 多个连续的宏，内容不要求对齐 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        ((_a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_b))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_NO_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { s_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_a) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_b); } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_FOO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 宏的继续符\`\\\`对齐的情况，不要求对齐 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XF_TEMPLATE_MACROS_HAS_RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ({                                      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_x) __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_x);            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (_x);               </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        (__ret);                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li><li><p>如果需要缩进预处理指令，请在在<code>#</code>号后面缩进，而不是在<code>#</code>号前面缩进。</p><blockquote><p>尽管 astyle 通过<code>--indent-preproc-block</code>命令可以自动缩进预处理指令，但是实测发现存在错误缩进多行注释的情况，因此暂未使用。</p></blockquote><p>如：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 正确示例 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#   define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) ((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(_x))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 错误示例 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifndef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    #define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UNUSED</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) ((</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)(_x))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ol><h4 id="类型定义、结构体、共用体、枚举类型等" tabindex="-1">类型定义、结构体、共用体、枚举类型等 <a class="header-anchor" href="#类型定义、结构体、共用体、枚举类型等" aria-label="Permalink to &quot;类型定义、结构体、共用体、枚举类型等&quot;">​</a></h4><p>xfusion 所有的 c 头文件/源文件都<strong>强制</strong>使用类型定义去替代结构体、共用体、枚举类型，包括浮点类型、整型等数据类型。</p><p><strong>命名要点：</strong></p><ol><li><p>类型定义、结构体、共用体。</p><ol><li><p>用<strong>类型定义</strong>替换所有的结构体、共用体、枚举类型。</p></li><li><p>结构体、共用体、枚举类型的名字用单下划线<code>_</code>加类型定义的名字。</p></li><li><p>类型定义的名字需要用<code>_t</code>后缀结尾，说明该类型是通过类型定义定义的。</p></li><li><p>通常都需要添加命名空间前缀。</p></li><li><p>通常使用<code>int32_t</code>、<code>uint8_t</code>等类型定义替换<code>int</code>、<code>unsigned char</code>等数据类型。</p></li><li><p>如下：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 结构体示例。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">* </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@details</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">* 1. 结构体**必须**用类型定义。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">* 2. 结构体名字是类型定义名字前加单下划线。如：\`_xf_templ_struct_t\`。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*    当然用 xf_templ_struct_s 也可以。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> _xf_templ_struct_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   xf_templ_int_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             /*!&lt; 这是一个数字 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p_str;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    /*!&lt; 这是一个字符串指针，前缀\`p_\`强调指针类型 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   union</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         /*!&lt; 结构体内的联合体或结构体等可以匿名 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                /*!&lt; 通过这个值可以修改整个共用体 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    /*!&lt; 结构体内的联合体或结构体等可以匿名 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val_u4: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /*!&lt; 这是位域的示例，u4 表示有 4 位，根据位置可能是 [0..3] */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val_bit4: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /*!&lt; 这是位域的示例，bit4 表示的是从 bit0 起数的第 5 位 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            uint8_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reserved: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /*!&lt; 这是位域中未使用的位 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } bits;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /*!&lt; 如果使用了英文缩写，应当在此说明缩写的原文 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   } data;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xf_templ_struct_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li><li><p>命名示例： TODO: 类型定义命名示例。</p></li></ol></li><li><p>枚举类型。</p><ol><li><p>枚举元素要求和宏定义一样，无特殊情况都<strong>必须大写</strong>。</p></li><li><p>不使用枚举类型定义变量（如以下示例代码中的<code>xf_templ_enum_t</code>），通常只使用枚举类型定义的枚举元素。</p><blockquote><p>为了避免不同编译器为枚举类型分配不同大小。 如 <code>components/xf_def/xf_err.h</code> 内的 <code>xf_err_code_t</code> 和 <code>xf_err_t</code>。使用 <code>xf_err_code_t</code> 内的枚举值，但不使用 <code>xf_err_code_t</code> 定义变量。</p></blockquote></li><li><p>枚举元素通常要求有一个最大值，并且该最大值通常不作为正常值使用。</p></li><li><p>除了只做索引的枚举元素以外，应当用<strong>功能</strong>代替其中的数字。</p></li><li><p>如：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 枚举类型示例。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@details</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 1. 枚举类型通过类型定义重命名。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 2. 枚举类型命名是类型定义名字前加单下划线。如 &quot;_xf_templ_enum_t&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *    用 xf_templ_enum_e 也可以。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 3. 枚举类型的值需要大写。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 4. 枚举值通常要求有一个最大值，并且该最大值使用时通常不作为正常值。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typedef</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> enum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> _xf_templ_enum_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   XF_TEMPL_ENUM_0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         /*!&lt; 枚举值 0，第一个枚举值通常要求手动赋     值 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   XF_TEMPL_ENUM_1,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                /*!&lt; 枚举值 1 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   XF_TEMPL_ENUM_2,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                /*!&lt; 枚举值 2 */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                                   /* 此处保留一行空行，以区分正常值和最大值 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   XF_TEMPL_ENUM_MAX,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              /*!&lt; 枚举值最大值 */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   XF_TEMPL_ENUM_DEFAULT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XF_TEMPL_ENUM_1,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /*!&lt; 枚举值默认值 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xf_templ_enum_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ol></li></ol><h4 id="函数、变量、常量、goto-标签等" tabindex="-1">函数、变量、常量、goto 标签等 <a class="header-anchor" href="#函数、变量、常量、goto-标签等" aria-label="Permalink to &quot;函数、变量、常量、goto 标签等&quot;">​</a></h4><p>xfusion c 语言代码都采用<code>snake_case</code>风格命名。也就是<code>unix like</code>风格。如<code>xf_evt_attach()</code>、<code>xf_evt_sys_init()</code>等等。 如需缩写，请从<a href="#缩写词表">缩写词表</a>中选取。</p><p><strong>命名要点：</strong></p><ol><li><p>函数。</p><p>函数命名的总体原则是：<code>{主语}_{谓语}_{宾语}</code>。</p><ol><li><p><code>{主语}</code>通常由<code>{前缀}_{模块}</code>组成，是发起动作的主体。</p><ol><li><code>{主语}</code><strong>不可</strong>省略。</li><li>如<code>xf_spi</code>表示 xfusion 中的 spi 模块（隐含 xf_hal）。</li><li>如<code>xf_spi_dev</code>表示发起动作的主语（主体）是 spi 设备(device)。</li></ol></li><li><p><code>{谓语}</code>即为动作，动作的承接对象可能是主语，也可能是宾语，取决于是否有宾语。</p><ol><li><p><code>{谓语}</code><strong>不可</strong>省略。</p><blockquote><p>好的示例如<code>xf_uart_get_tx_buffer_free()</code>，表示在 uart 中获取发送缓冲区剩余空间大小。 而如果去除<code>get</code>，<code>xf_uart_tx_buffer_free()</code>的则会产生歧义，可能的含义有，1. 同包含 get 的情况；2. 发送缓冲区剩余空间大小。</p></blockquote></li><li><p><code>{谓语}</code>优先使用具有相反含义的词组。词组列表见附录<a href="#反义或互斥词组">反义或互斥词组</a>。</p><ol><li>具有相反含义的常用词组的有： 获取/设置(get/set)、初始化/反初始化(initialize/deinitialize)、获取/释放(acquire/release)、创建/销毁(create/destroy)、添加/移除(add/remove)、上锁/解锁(lock/unlock)等。</li><li>其余没有相反含义的常用词组： 延时(delay)、是否(is)、检查(check)等。</li></ol></li></ol></li><li><p><code>{宾语}</code>即为动作的承接对象。</p><ol><li><code>{谓语}</code>可以省略。省略时表示动作的对象就是主语自己。 如<code>xf_delay_ms()</code>表示以 ms 为单位延时（隐含主语为系统或当前线程）。 如<code>xf_systime_init()</code>表示初始化<code>xf_systime</code>模块。</li></ol></li></ol></li><li><p>变量、常量。</p><ol><li><p>前缀。 前缀有助于使用者在使用时辨别当前变量的类型，目前有以下常用几种前缀。前缀可以组合使用。</p><ol><li><p><code>s_</code>，表示<strong>静态变量</strong>，无论是函数内或者文件内定义的静态变量都<strong>必须</strong>用<code>static</code>修饰；</p><p>如：<code>components/xf_log/xf_log.c</code>中的<code>static xf_log_level_t s_global_level = (xf_log_level_t)XF_LOG_DEFAULT_LEVEL;</code>。</p></li><li><p><code>g_</code>，表示<strong>全局变量</strong>，与<code>s_</code>的区别是能否通过<code>extern</code>等方式直接访问，只要能被直接访问（不含通过指针访问）到的变量，都<strong>必须</strong>用<code>g_</code>。</p></li><li><p><code>c_</code>，表示<strong>常量</strong>。位于只读数据段的数据。对于常量<strong>推荐</strong>使用<code>c_</code>前缀。</p><ol><li><p>常量可以在头文件中声明，并在别的文件内调用。</p></li><li><p>有<code>const</code>修饰的变量不一定是常量。</p></li><li><p>对于指针应当特别小心，只有满足： 1. 该指针不可改变指向；2. 不可通过该指针修改指向的空间的数据；3. 该指针指向的空间的数据不会改变。才能直接在在头文件中声明。以下示例说明了能在头文件中声明的指针的示例。</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 一个变量数组 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> buf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 以下情况都可能存在数据竞争，都不能在头文件中直接声明 */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 指向变量数组的指针变量 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">               *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p_buf   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> buf;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 指向变量数组的指针常量 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        *const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pc_buf  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> buf;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 指向变量数组的指针变量，且不可通过当前指针修改指向的空间。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@note</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 尽管不可通过当前指针修改指向的空间，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 但是指针的指向可能改变，存在数据竞争风险。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cp_buf  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> buf;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@brief</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 指向变量数组的指针常量，且不可通过当前指针修改指向的空间。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@note</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 尽管不可通过当前指针修改指向的空间，指针的指向也不能改变，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 但是指向的空间是变量数组，在通过 cpc_buf 读取数据过程中，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 数据有可能改变，因此存在风险。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 如：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 初始时，buf[0...9] == &quot;abcdef\\0\\0\\0\\0&quot;，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 通过 cpc_buf 读取 3 个字符后，线程切换到修改 buf 的线程，并修改 buf：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * buf[0...9] == &quot;012345\\0\\0\\0\\0&quot;，线程再切换回通过 cpc_buf 读取数据的线程：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 最终读取的数据是: &quot;abc345\\0\\0\\0\\0&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  *const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cpc_buf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> buf;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 能在头文件中声明的情况是（命名空间假设为 xf_tmp） */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* .h */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">extern</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> g_xf_tmp_character_literal;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* .c */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> g_xf_tmp_character_literal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;hello world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 实际上也可以在 .h 中直接 */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const char *const g_xf_tmp_character_literal = &quot;hello world&quot;;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></li></ol></li><li><p><code>p_</code>，表示<strong>指针</strong>。<strong>强烈推荐</strong>指针使用<code>p_</code>前缀。二级指针可以用<code>pp_</code>或者<code>p_xxx_ptr</code>。二级指针以上的级别的指针通常不使用。</p></li></ol></li></ol></li><li><p>goto 标签。 通常<strong>建议</strong>单下划线开头，如<code>_xf_xxx_init_err</code>，表示 xxx 模块初始化错误时的处理，如释放资源等等。</p></li></ol><h2 id="内容编排风格" tabindex="-1">内容编排风格 <a class="header-anchor" href="#内容编排风格" aria-label="Permalink to &quot;内容编排风格&quot;">​</a></h2><p>详情见详细示例<code>examples/get_started/xf_template/main/xf_template_source_detail.c</code>。</p><p>👉<a href="#">xf_template_source_detail.c</a>👈</p><p>请根据内容提示符编写代码。</p><h3 id="头文件顺序" tabindex="-1">头文件顺序 <a class="header-anchor" href="#头文件顺序" aria-label="Permalink to &quot;头文件顺序&quot;">​</a></h3><ol><li>当前组件的公共头文件，也就是当前组件对外提供的功能的头文件；如：<code>#include &quot;xf_template_header_detail.h&quot;</code>；</li><li>标准库，如 <code>#include &lt;stdio.h&gt;</code>；</li><li>其他 POSIX 标准标头，如：<code>#include &lt;sys/time.h&gt;</code>；</li><li>本文件所需要的其他组件的头文件，如：<code>#include &quot;xf_log.h&quot;</code>、<code>#include &quot;xf_spi.h&quot;</code>；</li><li>本文件所需要的当前组件的其他头文件或者私有头文件。</li></ol><blockquote><p>备注：&quot;当前组件的公共头文件&quot;也可放到&quot;本文件所需要的当前组件的其他头文件或者私有头文件&quot;之前 项目中很多历史遗留代码还没修改顺序，请以该顺序为准。</p></blockquote><p>如：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ==================== [Includes] ========================================== */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xf_template_header_detail.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ENABLE_XF_HAL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xf_hal.h&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* ENABLE_XF_HAL */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xf_component_template.h&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="其余细则" tabindex="-1">其余细则 <a class="header-anchor" href="#其余细则" aria-label="Permalink to &quot;其余细则&quot;">​</a></h3><ul><li>不要以空行开始或者结束函数。<div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> function1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    do_one_thing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    do_another_thing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                                /* 不正确，函数结尾不要空行 */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                                /* 函数和函数之间需要空行 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> function2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                                /* 不正确，函数开始不要空行 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> var </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (var </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SOME_CONSTANT) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        do_stuff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">var);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li><li>在条件和循环关键字后添加单空格（自动格式化会自动完成）。<div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (condition) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /*!&lt; 正确 */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /*!&lt; 正确 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    case</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CONST; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /*!&lt; 不正确，关键词周围缺少空格 */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* ... */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li>每行最大长度为 120 个字符（超长时自动格式化会自动换行）。</li><li>在合适的运算符周围添加空格（自动格式化会自动完成）。</li><li>如果不再需要某些代码，请将其完全删除。如果需要临时禁用，请在注释的代码周围说明原因。<code>#if 0 ... #endif</code>代码块同样。</li></ul><h1 id="附录" tabindex="-1">附录 <a class="header-anchor" href="#附录" aria-label="Permalink to &quot;附录&quot;">​</a></h1><h2 id="缩写词表" tabindex="-1">缩写词表 <a class="header-anchor" href="#缩写词表" aria-label="Permalink to &quot;缩写词表&quot;">​</a></h2><table><thead><tr><th style="text-align:left;">中文</th><th style="text-align:left;">英文</th><th style="text-align:left;">缩写</th></tr></thead><tbody><tr><td style="text-align:left;">参数</td><td style="text-align:left;">argument</td><td style="text-align:left;">arg</td></tr><tr><td style="text-align:left;">参数</td><td style="text-align:left;">parameter</td><td style="text-align:left;">param</td></tr><tr><td style="text-align:left;">描述符</td><td style="text-align:left;">descriptor</td><td style="text-align:left;">dsc</td></tr><tr><td style="text-align:left;">缓冲区</td><td style="text-align:left;">buffer</td><td style="text-align:left;">buf</td></tr><tr><td style="text-align:left;">命令</td><td style="text-align:left;">command</td><td style="text-align:left;">cmd</td></tr><tr><td style="text-align:left;">配置</td><td style="text-align:left;">configuration</td><td style="text-align:left;">cfg</td></tr><tr><td style="text-align:left;">控制</td><td style="text-align:left;">control</td><td style="text-align:left;">ctrl</td></tr><tr><td style="text-align:left;">比较</td><td style="text-align:left;">compare</td><td style="text-align:left;">cmp</td></tr><tr><td style="text-align:left;">位置</td><td style="text-align:left;">position</td><td style="text-align:left;">pos</td></tr><tr><td style="text-align:left;">错误</td><td style="text-align:left;">error</td><td style="text-align:left;">err</td></tr><tr><td style="text-align:left;">时钟</td><td style="text-align:left;">clock</td><td style="text-align:left;">clk</td></tr><tr><td style="text-align:left;">设备</td><td style="text-align:left;">device</td><td style="text-align:left;">dev</td></tr><tr><td style="text-align:left;">消息</td><td style="text-align:left;">message</td><td style="text-align:left;">msg</td></tr><tr><td style="text-align:left;">字符串</td><td style="text-align:left;">string</td><td style="text-align:left;">str</td></tr><tr><td style="text-align:left;">回调</td><td style="text-align:left;">call-back</td><td style="text-align:left;">cb</td></tr><tr><td style="text-align:left;">分配</td><td style="text-align:left;">allocate</td><td style="text-align:left;">alloc</td></tr><tr><td style="text-align:left;">临时</td><td style="text-align:left;">temp</td><td style="text-align:left;">tmp</td></tr><tr><td style="text-align:left;">对象</td><td style="text-align:left;">object</td><td style="text-align:left;">obj</td></tr><tr><td style="text-align:left;">同步</td><td style="text-align:left;">synchronize</td><td style="text-align:left;">sync</td></tr><tr><td style="text-align:left;">信号量</td><td style="text-align:left;">semaphore</td><td style="text-align:left;">sem</td></tr><tr><td style="text-align:left;">互斥量</td><td style="text-align:left;">mutex</td><td style="text-align:left;">mtx</td></tr><tr><td style="text-align:left;">注册/寄存器</td><td style="text-align:left;">register</td><td style="text-align:left;">reg</td></tr><tr><td style="text-align:left;">之前</td><td style="text-align:left;">previous</td><td style="text-align:left;">prev</td></tr><tr><td style="text-align:left;">当前</td><td style="text-align:left;">current</td><td style="text-align:left;">curr</td></tr><tr><td style="text-align:left;">最大</td><td style="text-align:left;">maximum</td><td style="text-align:left;">max</td></tr><tr><td style="text-align:left;">最小</td><td style="text-align:left;">minimum</td><td style="text-align:left;">min</td></tr><tr><td style="text-align:left;">增加</td><td style="text-align:left;">increment</td><td style="text-align:left;">inc</td></tr><tr><td style="text-align:left;">减少</td><td style="text-align:left;">decrement</td><td style="text-align:left;">dec</td></tr><tr><td style="text-align:left;">初始化</td><td style="text-align:left;">initialize</td><td style="text-align:left;">init</td></tr><tr><td style="text-align:left;">反初始化</td><td style="text-align:left;">deinitialize</td><td style="text-align:left;">deinit</td></tr></tbody></table><h2 id="反义或互斥词组" tabindex="-1">反义或互斥词组 <a class="header-anchor" href="#反义或互斥词组" aria-label="Permalink to &quot;反义或互斥词组&quot;">​</a></h2><table><thead><tr><th style="text-align:left;">中文</th><th style="text-align:left;">英文</th></tr></thead><tbody><tr><td style="text-align:left;">添加/删除</td><td style="text-align:left;">add/remove</td></tr><tr><td style="text-align:left;">添加/删除</td><td style="text-align:left;">add/delete</td></tr><tr><td style="text-align:left;">开始/结束</td><td style="text-align:left;">begin/end</td></tr><tr><td style="text-align:left;">创建/销毁</td><td style="text-align:left;">create/destroy</td></tr><tr><td style="text-align:left;">插入/删除</td><td style="text-align:left;">insert/delete</td></tr><tr><td style="text-align:left;">递增/递减</td><td style="text-align:left;">increment/decrement</td></tr><tr><td style="text-align:left;">锁定/解锁</td><td style="text-align:left;">lock/unlock</td></tr><tr><td style="text-align:left;">旧/新</td><td style="text-align:left;">old/new</td></tr><tr><td style="text-align:left;">源/目标</td><td style="text-align:left;">source/target</td></tr><tr><td style="text-align:left;">源/目标</td><td style="text-align:left;">source/destination</td></tr><tr><td style="text-align:left;">第一个/最后一个</td><td style="text-align:left;">first/last</td></tr><tr><td style="text-align:left;">放入/取出</td><td style="text-align:left;">put/get</td></tr><tr><td style="text-align:left;">打开/关闭</td><td style="text-align:left;">open/close</td></tr><tr><td style="text-align:left;">启动/停止</td><td style="text-align:left;">start/stop</td></tr><tr><td style="text-align:left;">显示/隐藏</td><td style="text-align:left;">show/hide</td></tr><tr><td style="text-align:left;">复制/粘贴</td><td style="text-align:left;">copy/paste</td></tr><tr><td style="text-align:left;">获取/释放</td><td style="text-align:left;">acquire/release</td></tr><tr><td style="text-align:left;">最小/最大</td><td style="text-align:left;">min/max</td></tr><tr><td style="text-align:left;">当前/之前</td><td style="text-align:left;">current/previous</td></tr><tr><td style="text-align:left;">当前/之前</td><td style="text-align:left;">current/next</td></tr><tr><td style="text-align:left;">下一个/之前</td><td style="text-align:left;">next/previous</td></tr><tr><td style="text-align:left;">发送/接收</td><td style="text-align:left;">send/receive</td></tr><tr><td style="text-align:left;">上/下</td><td style="text-align:left;">up/down</td></tr></tbody></table><h1 id="参考文献" tabindex="-1">参考文献 <a class="header-anchor" href="#参考文献" aria-label="Permalink to &quot;参考文献&quot;">​</a></h1><ol><li><a href="https://docs.espressif.com/projects/esp-idf/zh_CN/release-v5.0/esp32/contribute/style-guide.html" target="_blank" rel="noreferrer">Espressif IoT Development Framework Style Guide</a></li><li><a href="https://docs.lvgl.io/master/CODING_STYLE.html" target="_blank" rel="noreferrer">LVGL Coding style</a></li><li><a href="https://astyle.sourceforge.net/astyle.html" target="_blank" rel="noreferrer">Artistic Style 3.4.12 Documentation</a></li><li><a href="https://gitee.com/rtthread/rt-thread/blob/master/documentation/contribution_guide/coding_style_cn.md" target="_blank" rel="noreferrer">RT-Thread 编程风格</a></li></ol>`,83),t=[e];function p(h,k,r,d,c,g){return a(),i("div",null,t)}const y=s(l,[["render",p]]);export{E as __pageData,y as default};
